var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.makeIterator=function(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};
$jscomp.getGlobal=function(a){a=["object"==typeof globalThis&&globalThis,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,a];for(var b=0;b<a.length;++b){var c=a[b];if(c&&c.Math==Math)return c}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(a){function b(){this.batch_=null}function c(a){return a instanceof e?a:new e(function(b,c){b(a)})}if(a&&!$jscomp.FORCE_POLYFILL_PROMISE)return a;b.prototype.asyncExecute=function(a){if(null==this.batch_){this.batch_=[];var b=this;this.asyncExecuteFunction(function(){b.executeBatch_()})}this.batch_.push(a)};var d=$jscomp.global.setTimeout;b.prototype.asyncExecuteFunction=function(a){d(a,0)};b.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var a=
this.batch_;this.batch_=[];for(var b=0;b<a.length;++b){var c=a[b];a[b]=null;try{c()}catch(l){this.asyncThrow_(l)}}}this.batch_=null};b.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a;})};var e=function(a){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var b=this.createResolveAndReject_();try{a(b.resolve,b.reject)}catch(g){b.reject(g)}};e.prototype.createResolveAndReject_=function(){function a(a){return function(d){c||(c=!0,a.call(b,d))}}var b=this,c=!1;
return{resolve:a(this.resolveTo_),reject:a(this.reject_)}};e.prototype.resolveTo_=function(a){if(a===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(a instanceof e)this.settleSameAsPromise_(a);else{a:switch(typeof a){case "object":var b=null!=a;break a;case "function":b=!0;break a;default:b=!1}b?this.resolveToNonPromiseObj_(a):this.fulfill_(a)}};e.prototype.resolveToNonPromiseObj_=function(a){var b=void 0;try{b=a.then}catch(g){this.reject_(g);return}"function"==typeof b?
this.settleSameAsThenable_(b,a):this.fulfill_(a)};e.prototype.reject_=function(a){this.settle_(2,a)};e.prototype.fulfill_=function(a){this.settle_(1,a)};e.prototype.settle_=function(a,b){if(0!=this.state_)throw Error("Cannot settle("+a+", "+b+"): Promise already settled in state"+this.state_);this.state_=a;this.result_=b;this.executeOnSettledCallbacks_()};e.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var a=0;a<this.onSettledCallbacks_.length;++a)f.asyncExecute(this.onSettledCallbacks_[a]);
this.onSettledCallbacks_=null}};var f=new b;e.prototype.settleSameAsPromise_=function(a){var b=this.createResolveAndReject_();a.callWhenSettled_(b.resolve,b.reject)};e.prototype.settleSameAsThenable_=function(a,b){var c=this.createResolveAndReject_();try{a.call(b,c.resolve,c.reject)}catch(l){c.reject(l)}};e.prototype.then=function(a,b){function c(a,b){return"function"==typeof a?function(b){try{d(a(b))}catch(r){h(r)}}:b}var d,h,f=new e(function(a,b){d=a;h=b});this.callWhenSettled_(c(a,d),c(b,h));return f};
e.prototype["catch"]=function(a){return this.then(void 0,a)};e.prototype.callWhenSettled_=function(a,b){function c(){switch(d.state_){case 1:a(d.result_);break;case 2:b(d.result_);break;default:throw Error("Unexpected state: "+d.state_);}}var d=this;null==this.onSettledCallbacks_?f.asyncExecute(c):this.onSettledCallbacks_.push(c)};e.resolve=c;e.reject=function(a){return new e(function(b,c){c(a)})};e.race=function(a){return new e(function(b,d){for(var e=$jscomp.makeIterator(a),h=e.next();!h.done;h=
e.next())c(h.value).callWhenSettled_(b,d)})};e.all=function(a){var b=$jscomp.makeIterator(a),d=b.next();return d.done?c([]):new e(function(a,e){function h(b){return function(c){f[b]=c;g--;0==g&&a(f)}}var f=[],g=0;do f.push(void 0),g++,c(d.value).callWhenSettled_(h(f.length-1),e),d=b.next();while(!d.done)})};return e},"es6","es3");$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};
$jscomp.SymbolClass=function(a,b){this.$jscomp$symbol$id_=a;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:b})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};$jscomp.Symbol=function(){function a(c){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(c||"")+"_"+b++,c)}var b=0;return a}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.asyncIterator;a||(a=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.underscoreProtoCanBeSet=function(){var a={a:!0},b={};try{return b.__proto__=a,b.a}catch(c){}return!1};
$jscomp.setPrototypeOf="function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null;$jscomp.generator={};$jscomp.generator.ensureIteratorResultIsObject_=function(a){if(!(a instanceof Object))throw new TypeError("Iterator result "+a+" is not an object");};
$jscomp.generator.Context=function(){this.isRunning_=!1;this.yieldAllIterator_=null;this.yieldResult=void 0;this.nextAddress=1;this.finallyAddress_=this.catchAddress_=0;this.finallyContexts_=this.abruptCompletion_=null};$jscomp.generator.Context.prototype.start_=function(){if(this.isRunning_)throw new TypeError("Generator is already running");this.isRunning_=!0};$jscomp.generator.Context.prototype.stop_=function(){this.isRunning_=!1};
$jscomp.generator.Context.prototype.jumpToErrorHandler_=function(){this.nextAddress=this.catchAddress_||this.finallyAddress_};$jscomp.generator.Context.prototype.next_=function(a){this.yieldResult=a};$jscomp.generator.Context.prototype.throw_=function(a){this.abruptCompletion_={exception:a,isException:!0};this.jumpToErrorHandler_()};$jscomp.generator.Context.prototype["return"]=function(a){this.abruptCompletion_={"return":a};this.nextAddress=this.finallyAddress_};
$jscomp.generator.Context.prototype.jumpThroughFinallyBlocks=function(a){this.abruptCompletion_={jumpTo:a};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.yield=function(a,b){this.nextAddress=b;return{value:a}};$jscomp.generator.Context.prototype.yieldAll=function(a,b){var c=$jscomp.makeIterator(a),d=c.next();$jscomp.generator.ensureIteratorResultIsObject_(d);if(d.done)this.yieldResult=d.value,this.nextAddress=b;else return this.yieldAllIterator_=c,this.yield(d.value,b)};
$jscomp.generator.Context.prototype.jumpTo=function(a){this.nextAddress=a};$jscomp.generator.Context.prototype.jumpToEnd=function(){this.nextAddress=0};$jscomp.generator.Context.prototype.setCatchFinallyBlocks=function(a,b){this.catchAddress_=a;void 0!=b&&(this.finallyAddress_=b)};$jscomp.generator.Context.prototype.setFinallyBlock=function(a){this.catchAddress_=0;this.finallyAddress_=a||0};$jscomp.generator.Context.prototype.leaveTryBlock=function(a,b){this.nextAddress=a;this.catchAddress_=b||0};
$jscomp.generator.Context.prototype.enterCatchBlock=function(a){this.catchAddress_=a||0;a=this.abruptCompletion_.exception;this.abruptCompletion_=null;return a};$jscomp.generator.Context.prototype.enterFinallyBlock=function(a,b,c){c?this.finallyContexts_[c]=this.abruptCompletion_:this.finallyContexts_=[this.abruptCompletion_];this.catchAddress_=a||0;this.finallyAddress_=b||0};
$jscomp.generator.Context.prototype.leaveFinallyBlock=function(a,b){var c=this.finallyContexts_.splice(b||0)[0];if(c=this.abruptCompletion_=this.abruptCompletion_||c){if(c.isException)return this.jumpToErrorHandler_();void 0!=c.jumpTo&&this.finallyAddress_<c.jumpTo?(this.nextAddress=c.jumpTo,this.abruptCompletion_=null):this.nextAddress=this.finallyAddress_}else this.nextAddress=a};$jscomp.generator.Context.prototype.forIn=function(a){return new $jscomp.generator.Context.PropertyIterator(a)};
$jscomp.generator.Context.PropertyIterator=function(a){this.object_=a;this.properties_=[];for(var b in a)this.properties_.push(b);this.properties_.reverse()};$jscomp.generator.Context.PropertyIterator.prototype.getNext=function(){for(;0<this.properties_.length;){var a=this.properties_.pop();if(a in this.object_)return a}return null};$jscomp.generator.Engine_=function(a){this.context_=new $jscomp.generator.Context;this.program_=a};
$jscomp.generator.Engine_.prototype.next_=function(a){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_.next,a,this.context_.next_);this.context_.next_(a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.return_=function(a){this.context_.start_();var b=this.context_.yieldAllIterator_;if(b)return this.yieldAllStep_("return"in b?b["return"]:function(a){return{value:a,done:!0}},a,this.context_["return"]);this.context_["return"](a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.throw_=function(a){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_["throw"],a,this.context_.next_);this.context_.throw_(a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.yieldAllStep_=function(a,b,c){try{var d=a.call(this.context_.yieldAllIterator_,b);$jscomp.generator.ensureIteratorResultIsObject_(d);if(!d.done)return this.context_.stop_(),d;var e=d.value}catch(f){return this.context_.yieldAllIterator_=null,this.context_.throw_(f),this.nextStep_()}this.context_.yieldAllIterator_=null;c.call(this.context_,e);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.nextStep_=function(){for(;this.context_.nextAddress;)try{var a=this.program_(this.context_);if(a)return this.context_.stop_(),{value:a.value,done:!1}}catch(b){this.context_.yieldResult=void 0,this.context_.throw_(b)}this.context_.stop_();if(this.context_.abruptCompletion_){a=this.context_.abruptCompletion_;this.context_.abruptCompletion_=null;if(a.isException)throw a.exception;return{value:a["return"],done:!0}}return{value:void 0,done:!0}};
$jscomp.generator.Generator_=function(a){this.next=function(b){return a.next_(b)};this["throw"]=function(b){return a.throw_(b)};this["return"]=function(b){return a.return_(b)};$jscomp.initSymbolIterator();this[Symbol.iterator]=function(){return this}};$jscomp.generator.createGenerator=function(a,b){var c=new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(b));$jscomp.setPrototypeOf&&$jscomp.setPrototypeOf(c,a.prototype);return c};
$jscomp.asyncExecutePromiseGenerator=function(a){function b(b){return a.next(b)}function c(b){return a["throw"](b)}return new Promise(function(d,e){function f(a){a.done?d(a.value):Promise.resolve(a.value).then(b,c).then(f,e)}f(a.next())})};$jscomp.asyncExecutePromiseGeneratorFunction=function(a){return $jscomp.asyncExecutePromiseGenerator(a())};$jscomp.asyncExecutePromiseGeneratorProgram=function(a){return $jscomp.asyncExecutePromiseGenerator(new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(a)))};
var computationMethod="FE",inputData=Object.seal({mv:[805,805],caliber:[.102,.102],krupp:[2300,2300],mass:[15.2,15.2],normal:[10,10],cD:[.3536,.3536],threshold:[17,17],fusetime:[.01,.01],ra0_:[45,45],ra1_:[60,60],HESAP:[0,0],shellType:["AP","AP"],angle:[0,5,10,25,20,25,30,35],armor:70,inclination:0,width:18,shipName:["Vampire 0","Vampire 0"]}),graphSettings=Object.seal({minDist:"0",maxDist:"",tickDist:"1000",rounding:"3",enableFills:!1,shortNames:!0}),autoApply=[!0,!0];
function setComputation(a){computationMethod=a}
function addFormChange(){[[function(){inputData[this.id]=parseFloat(this.value)},["armor","inclination","width"]],[function(){var a=this.id.slice(-1);inputData.angle[a]=parseFloat(this.value)},"angle0 angle1 angle2 angle3 angle4 angle5 angle6 angle7".split(" ")],[function(){var a=this.id.slice(-1),b=this.id.slice(0,-1);inputData[b][a]=parseFloat(this.value)},"caliber0 caliber1 mv0 mv1 cD0 cD1 mass0 mass1 krupp0 krupp1 fusetime0 fusetime1 threshold0 threshold1 normal0 normal1 ra0_0 ra0_1 ra1_0 ra1_1 HESAP0 HESAP1".split(" ")],[function(){var a=
this.id.slice(-1);inputData.shipName[a]=this.value},["shipName0","shipName1"]],[function(){graphSettings[this.id]=this.value},["minDist","maxDist","tickDist","rounding"]],[function(){shellInstance.setDtMin(parseFloat(this.value))},["timeStep"]],[function(){shellInstance.setMin(parseFloat(this.value))},["minLaunch"]],[function(){shellInstance.setMax(parseFloat(this.value))},["maxLaunch"]]].map(function(a){a[1].map(function(b){document.getElementById(b).addEventListener("change",a[0])})});[[function(){graphSettings[this.id]=
this.checked},["enableFills","shortNames"]],[function(){autoApply[parseInt(this.id.slice(-1))]=this.checked},["autoApply0","autoApply1"]],[function(){console.log(this);graphShip[this.id.slice(-1)]=this.checked},["graphShip0","graphShip1"]]].map(function(a){a[1].map(function(b){document.getElementById(b).addEventListener(touchEvent,a[0],opts)})})}addTitles();var opts=Object.defineProperty({},"passive",{get:function(){supportsPassive=!0}}),touchEvent="ontouchstart"in window?"touchstart":"click";
document.getElementById("generate").addEventListener(touchEvent,collectMake,opts);function changeChevron(a){a.stopPropagation();$(a.target).prev("button").find("span.fa").toggleClass("fa-chevron-up fa-chevron-down")}
function addChevrons(){for(var a=$jscomp.makeIterator("descriptions parameters settingsTab impactCharts angleCharts postPenCharts".split(" ")),b=a.next();!b.done;b=a.next())$("#"+b.value).on("shown.bs.collapse hidden.bs.collapse",changeChevron);a=$jscomp.makeIterator(Object.entries({pC:3,CA:2,LA:8}));for(b=a.next();!b.done;b=a.next()){var c=$jscomp.makeIterator(b.value);b=c.next().value;c=c.next().value;for(var d=0;d<c;d++)$("#"+b+d).on("shown.bs.collapse hidden.bs.collapse",changeChevron)}}addChevrons();
addFormChange();function applyButton(){onSubmitPredefined(this.id.slice(-1))}for(var i=0;2>i;i++)document.getElementById("apply"+i).addEventListener(touchEvent,applyButton,opts);
function firstRun(){var a;return $jscomp.asyncExecutePromiseGeneratorProgram(function(b){shellInstance.setDtMin(.01);shellInstance.setMin(0);shellInstance.setMax(25);a={mv:[805,805],caliber:[.102,.102],krupp:[2300,2300],mass:[15.2,15.2],normal:[10,10],cD:[.3536,.3536],threshold:[17,17],fusetime:[.01,.01],ra0_:[45,45],ra1_:[60,60],HESAP:[0,0],shellType:["AP","AP"],angle:[0,5,10,25,20,25,30,35],armor:70,inclination:0,width:18,shipName:["PUSD503_Vampire 0","PUSD503_Vampire 0"]};makeGraphs(a);b.jumpToEnd()})}
$(document).ready(function(){var a,b;return $jscomp.asyncExecutePromiseGeneratorProgram(function(c){if(1==c.nextAddress)return showCollapsibles(),a=[0,1],b=a.map(function(a){return generateVersion(a)}),c.yield(Promise.all(b),2);c.jumpToEnd()})});var Module;
wasmFeatureDetect.simd().then(function(a){a?(console.log("vectorized"),ShellWasmV().then(function(a){Module=a;shellInstance=new Module.shell(2);firstRun()})):(console.log("unvectorized"),ShellWasm().then(function(a){Module=a;shellInstance=new Module.shell(2);firstRun()}))});
function showCollapsibles(){var a,b,c,d,e,f,k,h,g,l,n,m;return $jscomp.asyncExecutePromiseGeneratorProgram(function(q){a=["parametersToggle","impactChartToggle","angleChartToggle","postPenChartToggle"];b=$jscomp.makeIterator(a);for(c=b.next();!c.done;c=b.next())d=c.value,$("#"+d).click();e={PCT:3,ACT:2,AT:8};f=$jscomp.makeIterator(Object.entries(e));for(k=f.next();!k.done;k=f.next())for(h=k.value,g=$jscomp.makeIterator(h),l=g.next().value,n=g.next().value,m=0;m<n;m++)$("#"+l+m).click();q.jumpToEnd()})}
function addTitles(){for(var a=$jscomp.makeIterator(Object.entries({caliberL:"Diameter of the shell in meters. All else equal, higher caliber increase shell flight time and reduces penetration.",mvL:"Shell velocity at launch in meters per second. All else equal, higher muzzle velocity reduces shell flight time and increase penetration.",cDL:"Aerodynamic drag characteristic of the shell's shape. All else equal, higher drag coefficient increase shell flight time and reduces penetration.",massL:"Mass of the shell in kilograms. All else equal, higher mass decreases shell flight time and increases penetration.",
kruppL:"Penetration coefficient of the shell. All else equal, higher krupp increases penetration.",fusetimeL:"How many seconds it takes for the shell to detonate after fusing. Longer fusetime increases risk of overpenetration.",thresholdL:"How many milimeters of effective armor it takes for the shells arm. Higher fusing threshold increases the risk of overpenetration.",ra0L:"Minimum impact angle in degrees at which shells can ricochet - not affected by normalization.",ra1L:"Minimum impact angle in degrees at which shells always ricochet - not affected by normalization.",
HESAPL:"HE/SAP penetration of shell - if applicable.",normalL:"How many degrees of impact angle the shell can reduce. Higher normalization increases decreases effective armor thickness."})),b=a.next();!b.done;b=a.next()){var c=$jscomp.makeIterator(b.value);b=c.next().value;c=c.next().value;document.getElementById(b).title=c}}var versionValue=[],nationValue=[],typeValue=[],shipValue=[],shellValue=[],typeData=[],shellType=[],initialized=!1,compiled=!1,dataURL="static/data/";
function fetchJson(a,b){fetch(a).then(function(a){if(!a.ok)throw Error("Network response was not ok");return a.json()}).then(b)["catch"](function(a){console.error("There has been a problem with your fetch operation:",a)})}function generateVersion(a){fetchJson(dataURL+"versions.json",function(b){var c=document.getElementById("version"+a);c.innerHTML="";for(var d=b.length-1;0<=d;d--)c.innerHTML+="<option value="+b[d]+">"+b[d]+"</option>";onChangeVersion("version"+a)})}
function onChangeVersion(a){var b=parseInt(a.slice(-1));versionValue[b]=document.getElementById(a).value;generateNation("nation"+b)}function generateNation(a){var b=parseInt(a.slice(-1));fetchJson(dataURL+versionValue[b]+"/nations.json",function(b){var c=document.getElementById(a);c.innerHTML="";for(var e=0;e<b.length;e++)c.innerHTML+="<option value="+b[e]+">"+b[e]+"</option>";onChangeNation(a)})}
function onChangeNation(a){var b=parseInt(a.slice(-1));nationValue[b]=document.getElementById(a).value;generateType("type"+b)}function generateType(a){var b=parseInt(a.slice(-1));fetchJson(dataURL+versionValue[b]+"/"+nationValue[b]+"/shiptypes.json",function(b){var c=document.getElementById(a);c.innerHTML="";for(var e=0;e<b.length;e++)c.innerHTML+="<option value="+b[e]+">"+b[e]+"</option>";onChangeType(a)})}
function onChangeType(a){var b=parseInt(a.slice(-1));typeValue[b]=document.getElementById(a).value;generateShip("ship"+b)}
function generateShip(a){var b=parseInt(a.slice(-1));fetchJson(dataURL+versionValue[b]+"/"+nationValue[b]+"/"+nationValue[b]+"_"+typeValue[b]+".json",function(c){typeData[b]=c;var d=document.getElementById(a);d.innerHTML="";var e=[],f;for(f in c)e.push(f);e.sort(function(a,b){return c[a].Tier-c[b].Tier});e=$jscomp.makeIterator(e);for(f=e.next();!f.done;f=e.next())f=f.value,d.innerHTML+="<option value="+f+">Tier "+c[f].Tier+" "+f+"</option>";onChangeShip(a)})}
function onChangeShip(a){var b=parseInt(a.slice(-1));shipValue[b]=document.getElementById(a).value;generateShell("shell"+b)}function generateShell(a){var b=parseInt(a.slice(-1)),c=document.getElementById(a);c.innerHTML="";for(var d in typeData[b][shipValue[b]])d.includes("Artillery")&&(c.innerHTML+="<option value="+d+">"+d+"</option>");onChangeShell(a)}function onChangeShell(a){var b=parseInt(a.slice(-1));shellValue[b]=document.getElementById(a).value;generateShellType("shellType"+b)}
function generateShellType(a){var b=parseInt(a.slice(-1)),c=document.getElementById(a);c.innerHTML="";for(var d in typeData[b][shipValue[b]][shellValue[b]])c.innerHTML+="<option value="+d+">"+d+"</option>";onChangeShellType(a)}function onChangeShellType(a){var b=parseInt(a.slice(-1));shellType[b]=document.getElementById(a).value;autoApply[b]&&onSubmitPredefined(b)}var changeEvent=new Event("change");
function changeFormValue(a,b){var c=document.getElementById(a);b!=c.value&&(c.value=b,c.dispatchEvent(changeEvent))}
function onSubmitPredefined(a){var b=typeData[a][shipValue[a]][shellValue[a]][shellType[a]],c=shipValue[a];graphSettings.shortNames&&(c=c.split("_").slice(1).join(""));c+=" "+shellValue[a].slice(-1);changeFormValue("shipName"+a,c);changeFormValue("mv"+a,b.bulletSpeed);changeFormValue("caliber"+a,b.bulletDiametr);changeFormValue("krupp"+a,b.bulletKrupp);changeFormValue("mass"+a,b.bulletMass);changeFormValue("cD"+a,b.bulletAirDrag);changeFormValue("threshold"+a,b.bulletDetonatorThreshold);changeFormValue("fusetime"+
a,b.bulletDetonator);changeFormValue("ra0_"+a,b.bulletRicochetAt);changeFormValue("ra1_"+a,b.bulletAlwaysRicochetAt);changeFormValue("normal"+a,b.bulletCapNormalizeMaxAngle);c=0;"AP"==shellType[a]?c=0:"HE"==shellType[a]?c=b.alphaPiercingHE:"CS"==shellType[a]&&(c=b.alphaPiercingCS);changeFormValue("HESAP"+a,c)}var v_angles=[],numAngles=8;function getFloatValues(a){return parseFloat(document.getElementById(a).value)}function getIntValues(a){return parseInt(document.getElementById(a).value)}
var impactCharts=[],angleCharts=[],postCharts=[];function collectMake(){makeGraphs(inputData)}var shellInstance,impactSize,postPenSize,shipName,shipWidth=[],xAxesDistance;function completed(){var a=this.chart.ctx.canvas.id,b=document.getElementById(a).toDataURL("image/png");a=document.getElementById(a.slice(0,-1)+"Link"+a.slice(-1));a.href=b;a.download=this.chart.config.options.title.text+".png"}var animationCommon={onComplete:completed};function addCommas(a,b,c){return a.toLocaleString()}
var targetedArmor,targetInclination;
function makeGraphs(a){var b,c,d,e,f,k,h,g,l,n,m,q,u,p,r,t;return $jscomp.asyncExecutePromiseGeneratorProgram(function(v){b=a.mv;c=a.caliber;d=a.krupp;e=a.mass;f=a.normal;k=a.cD;h=a.threshold;g=a.fusetime;l=a.ra0_;n=a.ra1_;m=a.armor;q=a.inclination;u=a.width;v_angles=a.angle;shipName=a.shipName;for(p=0;2>p;p++)shellInstance.setValues(c[p],b[p],k[p],e[p],d[p],f[p],g[p],h[p],l[p],n[p],p);switch(computationMethod){case "AB5":shellInstance.calcImpactAdamsBashforth5();break;case "RK2":shellInstance.calcImpactRungeKutta2();
break;case "RK4":shellInstance.calcImpactRungeKutta4();break;case "FE":shellInstance.calcImpactForwardEuler()}shellInstance.calcAngles(m,q);shellInstance.calcPostPen(m,q,v_angles,!0,!0);impactSize=shellInstance.getImpactSize();postPenSize=shellInstance.getPostPenSize();r=0;shellInstance.getImpactPoint(impactSize-1,Module.impactDataIndex.distance.value,1)>shellInstance.getImpactPoint(impactSize-1,Module.impactDataIndex.distance.value,0)&&(r=1);shipWidth=[];for(t=0;t<impactSize;t++)shipWidth.push({x:shellInstance.getImpactPoint(t,
Module.impactDataIndex.distance.value,r),y:u});Chart.plugins.register({beforeDraw:function(a){var b=a.chart.ctx;b.fillStyle="white";b.fillRect(0,0,a.chart.width,a.chart.height)}});xAxesDistance=[{scaleLabel:{display:!0,labelString:"Distance from Launch (m)"},ticks:{callback:addCommas}}];""!==graphSettings.minDist&&(xAxesDistance[0].ticks.min=parseFloat(graphSettings.minDist));""!==graphSettings.maxDist&&(xAxesDistance[0].ticks.max=parseFloat(graphSettings.maxDist));""!==graphSettings.tickDist&&(xAxesDistance[0].ticks.stepSize=
parseFloat(graphSettings.tickDist));targetedArmor="Armor Thickness: "+m+"mm";targetInclination="Vertical Inclination: "+q+"\u00c2\u00b0";makeImpactCharts();makeAngleCharts();makePostPenCharts();v.jumpToEnd()})}
function generatePoint(a,b,c,d){var e,f,k,h,g,l,n;return $jscomp.asyncExecutePromiseGeneratorProgram(function(m){e=[];if(0==b)if(c!=Module.impactDataIndex.impactAHD.value)for(f=0;f<impactSize;f++)e.push({x:shellInstance.getImpactPoint(f,Module.impactDataIndex.distance.value,a),y:shellInstance.getImpactPoint(f,c,a)});else for(k=0;k<impactSize;k++)e.push({x:shellInstance.getImpactPoint(k,Module.impactDataIndex.distance.value,a),y:-1*shellInstance.getImpactPoint(k,c,a)});else if(1==b)for(h=0;h<impactSize;h++)e.push({x:shellInstance.getImpactPoint(h,
Module.impactDataIndex.distance.value,a),y:shellInstance.getAnglePoint(h,c,a)});else if(2==b)if(c!=Module.postPenDataIndex.xwf.value)for(g=0;g<impactSize;g++)0>shellInstance.getPostPenPoint(g,Module.postPenDataIndex.xwf.value,d,a)&&e.push({x:shellInstance.getImpactPoint(g,Module.impactDataIndex.distance.value,a),y:shellInstance.getPostPenPoint(g,c,d,a)});else for(l=0;l<impactSize;l++)n=shellInstance.getPostPenPoint(l,c,d,a),0<=n&&e.push({x:shellInstance.getImpactPoint(l,Module.impactDataIndex.distance.value,
a),y:n});else console.log("Invalid Type");return m["return"](e)})}function createUpdateChart(a,b,c,d){a[b]?(a[b].type=d.type,a[b].data=d.data,a[b].options=d.options,a[b].update()):a[b]=new Chart(document.getElementById(c),d)}
function roundStringNumberWithoutTrailingZeroes(a,b){if(2!=arguments.length)throw Error("2 arguments required");a=String(a);if(-1!=a.indexOf("e+"))throw Error("num too large");if(-1==a.indexOf("."))return a;var c=a.split("."),d=c[0];c=c[1];var e=5<=c[b];c=c.slice(0,b);if(e)if(/^9+$/.test(c))d=Number(d)+1;else{for(e=b-1;;)if("9"==c[e])c=c.substr(0,e)+"0"+c.substr(e+1),e--;else{c=c.substr(0,e)+(Number(c[e])+1)+c.substr(e+1);break}d=d+"."+c}else d=d+"."+c;return d.replace(/0+$/,"")}
function addTooltipCallbackImpact(a,b){for(var c=[],d=1;d<arguments.length;++d)c[d-1]=arguments[d];a.options.tooltips={enabled:!0,callbacks:{}};if(""!==graphSettings.rounding&&"0"!==graphSettings.rounding){var e=parseInt(graphSettings.rounding);a.options.tooltips.callbacks={label:function(a,b){var d=roundStringNumberWithoutTrailingZeroes(a.label,e),f=roundStringNumberWithoutTrailingZeroes(a.value,e);return 0==a.datasetIndex%2?c[0](d,f):c[1](d,f)}}}else a.options.tooltips.callbacks={label:function(a,
b){var d=a.label,e=a.value;return 0==a.datasetIndex%2?c[0](d,e):c[1](d,e)}}}function penetrationToolTipLabel(a,b){return"("+a+"m, "+b+"mm)"}function angleTooltipLabel(a,b){return"("+a+"m, "+b+"\u00c2\u00b0)"}function velocityTooltipLabel(a,b){return"("+a+"m, "+b+"m/s)"}function timeTooltipLabel(a,b){return"("+a+"m, "+b+"s)"}function filterLegend(a,b){return"_remove_"!=a.text}var commonPointRadius=0,graphShip=[!0,!0],colors=[["#3e95cd","#FFA500","#FFD700"],["#008000","#FF0000","#FF0090"]];
function makeImpactCharts(){var a,b,c,d,e,f,k,h,g,l,n,m;return $jscomp.asyncExecutePromiseGeneratorProgram(function(q){if(1==q.nextAddress)return a=[[0,0,Module.impactDataIndex.ePenHN.value,0],[0,0,Module.impactDataIndex.impactAHD.value,0],[1,0,Module.impactDataIndex.ePenHN.value,0],[1,0,Module.impactDataIndex.impactAHD.value,0],[0,0,Module.impactDataIndex.ePenDN.value,0],[0,0,Module.impactDataIndex.impactADD.value,0],[1,0,Module.impactDataIndex.ePenDN.value,0],[1,0,Module.impactDataIndex.impactADD.value,
0],[0,0,Module.impactDataIndex.impactV.value,0],[0,0,Module.impactDataIndex.tToTargetA.value,0],[1,0,Module.impactDataIndex.impactV.value,0],[1,0,Module.impactDataIndex.tToTargetA.value,0]],b=a.map(function(a){return generatePoint(a[0],a[1],a[2],a[3])}),q.yield(Promise.all(b),2);c=q.yieldResult;d={id:"Penetration",postition:"left",scaleLabel:{display:!0},ticks:{stepSize:100,callback:addCommas}};f=e={id:"Angle",position:"right",scaleLabel:{display:!0}};f.scaleLabel.labelString="Belt Impact Angle (\u00c2\u00b0)";
k=d;k.scaleLabel.labelString="Belt Penetration (mm)";h={type:"scatter",data:{datasets:[]},options:{title:{display:!0,text:"Horizontal Penetration and Impact Angle"},scales:{xAxes:xAxesDistance,yAxes:[k,f]},animation:animationCommon}};addTooltipCallbackImpact(h,penetrationToolTipLabel,angleTooltipLabel);graphShip.map(function(a,b){a&&h.data.datasets.push({data:c[2*b],showLine:!0,label:"Effective Penetration "+shipName[b],yAxisID:"Penetration",borderColor:colors[b][0],fill:!1,pointRadius:commonPointRadius,
pointHitRadius:5},{data:c[2*b+1],showLine:!0,label:"Impact Angle "+shipName[b],yAxisID:"Angle",borderColor:colors[b][1],fill:!1,pointRadius:commonPointRadius,pointHitRadius:5})});createUpdateChart(impactCharts,0,"penChart0",h);g=e;g.scaleLabel.labelString="Deck Impact Angle (\u00c2\u00b0)";l=d;l.scaleLabel.labelString="Deck Penetration (mm)";n={type:"scatter",data:{datasets:[]},options:{title:{display:!0,text:"Deck Penetration and Impact Angle"},scales:{xAxes:xAxesDistance,yAxes:[l,g]},animation:animationCommon}};
addTooltipCallbackImpact(n,penetrationToolTipLabel,angleTooltipLabel);graphShip.map(function(a,b){a&&n.data.datasets.push({data:c[2*b+4],showLine:!0,label:"Effective Deck Penetration "+shipName[b],yAxisID:"Penetration",borderColor:colors[b][0],fill:!1,pointRadius:commonPointRadius,pointHitRadius:5},{data:c[2*b+5],showLine:!0,label:"Deck Impact Angle "+shipName[b],yAxisID:"Angle",borderColor:colors[b][1],fill:!1,pointRadius:commonPointRadius,pointHitRadius:5})});createUpdateChart(impactCharts,1,"penChart1",
n);m={type:"scatter",data:{datasets:[]},options:{title:{display:!0,text:"Shell Flight Time and Impact Velocity"},scales:{xAxes:xAxesDistance,yAxes:[{id:"Impact Velocity",postition:"left",scaleLabel:{display:!0,labelString:"Impact Velocity (m/s)"},ticks:{stepSize:100}},{id:"Time",position:"right",scaleLabel:{display:!0,labelString:"Flight Time (s)"}}]},animation:animationCommon}};addTooltipCallbackImpact(m,velocityTooltipLabel,timeTooltipLabel);graphShip.map(function(a,b){a&&m.data.datasets.push({data:c[2*
b+8],showLine:!0,label:"Impact Velocity "+shipName[b],yAxisID:"Impact Velocity",borderColor:colors[b][0],fill:!1,pointRadius:commonPointRadius,pointHitRadius:5},{data:c[2*b+9],showLine:!0,label:"Flight Time "+shipName[b],yAxisID:"Time",borderColor:colors[b][1],fill:!1,pointRadius:commonPointRadius,pointHitRadius:5})});createUpdateChart(impactCharts,2,"penChart2",m);q.jumpToEnd()})}
function addTooltipCallbackAngles(a){a.options.tooltips={enabled:!0,callbacks:{}};if(""!==graphSettings.rounding&&"0"!==graphSettings.rounding){var b=parseInt(graphSettings.rounding);a.options.tooltips.callbacks={label:function(a,d){return angleTooltipLabel(roundStringNumberWithoutTrailingZeroes(a.label,b),roundStringNumberWithoutTrailingZeroes(a.value,b))}}}else a.options.tooltips.callbacks={label:function(a,b){return angleTooltipLabel(a.label,a.value)}}}
function generateAngleFillArmor(a){for(var b=[[],[],[]],c=0;c<impactSize;c++){var d=shellInstance.getAnglePoint(c,Module.angleDataIndex.armorD.value,a),e=shellInstance.getAnglePoint(c,Module.angleDataIndex.ra0D.value,a),f=shellInstance.getAnglePoint(c,Module.angleDataIndex.ra1D.value,a);d>f&&b[2].push({x:shellInstance.getImpactPoint(c,Module.impactDataIndex.distance.value,a),y:d});f=d<f?d:f;f>e&&b[1].push({x:shellInstance.getImpactPoint(c,Module.impactDataIndex.distance.value,a),y:f});d=d<e?d:e;b[0].push({x:shellInstance.getImpactPoint(c,
Module.impactDataIndex.distance.value,a),y:d})}return b}
function generateAngleFillFuse(a){for(var b=[[],[],[]],c=0;c<impactSize;c++){var d=shellInstance.getAnglePoint(c,Module.angleDataIndex.fuseD.value,a),e=shellInstance.getAnglePoint(c,Module.angleDataIndex.ra0D.value,a),f=shellInstance.getAnglePoint(c,Module.angleDataIndex.ra1D.value,a),k=d<e?e:d,h=d<f?f:d;d<e&&b[0].push({x:shellInstance.getImpactPoint(c,Module.impactDataIndex.distance.value,a),y:d});k<f&&b[1].push({x:shellInstance.getImpactPoint(c,Module.impactDataIndex.distance.value,a),y:k});b[2].push({x:shellInstance.getImpactPoint(c,
Module.impactDataIndex.distance.value,a),y:h})}return b}
function makeAngleCharts(){var a,b,c,d,e;return $jscomp.asyncExecutePromiseGeneratorProgram(function(f){if(1==f.nextAddress)return a=[[0,1,Module.angleDataIndex.armorD.value,0],[0,1,Module.angleDataIndex.ra0D.value,0],[0,1,Module.angleDataIndex.ra1D.value,0],[1,1,Module.angleDataIndex.armorD.value,0],[1,1,Module.angleDataIndex.ra0D.value,0],[1,1,Module.angleDataIndex.ra1D.value,0],[0,1,Module.angleDataIndex.fuseD.value,0],[1,1,Module.angleDataIndex.fuseD.value,0]],b=a.map(function(a){return generatePoint(a[0],
a[1],a[2],a[3])}),f.yield(Promise.all(b),2);c=f.yieldResult;d={type:"scatter",data:{datasets:[]},options:{title:{display:!0,text:"Maximum Angle for Perforation | "+targetedArmor+" | "+targetInclination},scales:{xAxes:xAxesDistance,yAxes:[{id:"angle",postition:"left",scaleLabel:{display:!0,labelString:"Lateral Angle (\u00c2\u00b0)"},ticks:{min:0}}]},legend:{labels:{filter:filterLegend}},animation:animationCommon}};addTooltipCallbackAngles(d);graphShip.map(function(a,b){if(a&&(d.data.datasets.push({data:c[3*
b],showLine:!0,label:"Maximum Perforation Angle "+shipName[b],yAxisID:"angle",backgroundColor:Samples.utils.transparentize(colors[b][0]),borderColor:colors[b][0],fill:!1,pointRadius:commonPointRadius,pointHitRadius:5},{data:c[3*b+1],showLine:!0,borderDash:[5,5],label:"Start Ricochet "+shipName[b],yAxisID:"angle",backgroundColor:Samples.utils.transparentize(colors[b][1]),borderColor:colors[b][1],fill:!1,pointRadius:commonPointRadius,pointHitRadius:5},{data:c[3*b+2],showLine:!0,borderDash:[5,5],label:"Always Ricochet "+
shipName[b],yAxisID:"angle",backgroundColor:Samples.utils.transparentize(colors[b][2]),borderColor:colors[b][2],fill:!1,pointRadius:commonPointRadius,pointHitRadius:5}),graphSettings.enableFills)){var e=generateAngleFillArmor(b);d.data.datasets.push({data:e[2],showLine:!0,borderWidth:0,label:"_remove_",yAxisID:"angle",backgroundColor:Samples.utils.transparentize(colors[b][0]),borderColor:colors[b][0],fill:"-1",pointRadius:0,pointHitRadius:0},{data:e[1],showLine:!0,borderWidth:0,label:"_remove_",yAxisID:"angle",
backgroundColor:Samples.utils.transparentize(colors[b][2]),borderColor:colors[b][2],fill:"-3",pointRadius:0,pointHitRadius:0},{data:e[0],showLine:!0,borderWidth:0,label:"_remove_",yAxisID:"angle",backgroundColor:Samples.utils.transparentize(colors[b][1]),borderColor:colors[b][1],fill:!0,pointRadius:0,pointHitRadius:0})}});createUpdateChart(angleCharts,0,"angleChart0",d);e={type:"scatter",data:{datasets:[]},options:{title:{display:!0,text:"Minimum Fusing Angle | "+targetedArmor+" | "+targetInclination},
scales:{xAxes:xAxesDistance,yAxes:[{id:"angle",postition:"left",scaleLabel:{display:!0,labelString:"Lateral Angle (\u00c2\u00b0)"},ticks:{min:0}}]},legend:{labels:{filter:filterLegend}},animation:animationCommon}};addTooltipCallbackAngles(e);graphShip.map(function(a,b){if(a&&(e.data.datasets.push({data:c[b+6],showLine:!0,label:"Minimum Fusing Angle "+shipName[b],yAxisID:"angle",backgroundColor:Samples.utils.transparentize(colors[b][0]),borderColor:colors[b][0],fill:!1,pointRadius:commonPointRadius,
pointHitRadius:5},{data:c[3*b+1],showLine:!0,borderDash:[5,5],label:"Start Ricochet "+shipName[b],yAxisID:"angle",backgroundColor:Samples.utils.transparentize(colors[b][1]),borderColor:colors[b][1],fill:!1,pointRadius:commonPointRadius,pointHitRadius:5},{data:c[3*b+2],showLine:!0,borderDash:[5,5],label:"Always Ricochet "+shipName[b],yAxisID:"angle",backgroundColor:Samples.utils.transparentize(colors[b][2]),borderColor:colors[b][2],fill:!1,pointRadius:commonPointRadius,pointHitRadius:5}),graphSettings.enableFills)){var d=
generateAngleFillFuse(b);e.data.datasets.push({data:d[0],showLine:!0,borderWidth:0,label:"_remove_",yAxisID:"angle",backgroundColor:Samples.utils.transparentize(colors[b][2]),borderColor:colors[b][2],fill:"-2",pointRadius:0,pointHitRadius:0},{data:d[1],showLine:!0,borderWidth:0,label:"_remove_",yAxisID:"angle",backgroundColor:Samples.utils.transparentize(colors[b][1]),borderColor:colors[b][1],fill:"-2",pointRadius:0,pointHitRadius:0},{data:d[2],showLine:!0,borderWidth:0,label:"_remove_",yAxisID:"angle",
backgroundColor:Samples.utils.transparentize(colors[b][0]),borderColor:colors[b][0],fill:"end",pointRadius:0,pointHitRadius:0})}});createUpdateChart(angleCharts,1,"angleChart1",e);f.jumpToEnd()})}
function addTooltipCallbackPostPen(a){a.options.tooltips={enabled:!0,callbacks:{}};if(""!==graphSettings.rounding&&"0"!==graphSettings.rounding){var b=parseInt(graphSettings.rounding);a.options.tooltips.callbacks={label:function(a,d){return postPenToolTipLabels(roundStringNumberWithoutTrailingZeroes(a.label,b),roundStringNumberWithoutTrailingZeroes(a.value,b))}}}else a.options.tooltips.callbacks={label:function(a,b){return postPenToolTipLabels(a.label,a.value)}}}
function postPenToolTipLabels(a,b){return"("+a+" m, "+b+" m)"}
function makePostPenCharts(){var a,b,c,d,e,f,k,h;return $jscomp.asyncExecutePromiseGeneratorProgram(function(g){1==g.nextAddress&&(document.getElementById("width"),a="Fused ",b="No Fusing ",c=[],d={$jscomp$loop$prop$i$22$24:0});if(5!=g.nextAddress){if(!(d.$jscomp$loop$prop$i$22$24<numAngles))return g.jumpTo(0);e="Lateral Angle "+d.$jscomp$loop$prop$i$22$24+": "+v_angles[d.$jscomp$loop$prop$i$22$24]+"\u00c2\u00b0";document.getElementById("AT"+d.$jscomp$loop$prop$i$22$24).textContent=e;f=[[0,2,Module.postPenDataIndex.xwf.value,
d.$jscomp$loop$prop$i$22$24],[0,2,Module.postPenDataIndex.x.value,d.$jscomp$loop$prop$i$22$24],[1,2,Module.postPenDataIndex.xwf.value,d.$jscomp$loop$prop$i$22$24],[1,2,Module.postPenDataIndex.x.value,d.$jscomp$loop$prop$i$22$24]];k=f.map(function(a){return generatePoint(a[0],a[1],a[2],a[3])});h=d;return g.yield(Promise.all(k),5)}h.$jscomp$loop$prop$results$25=g.yieldResult;c[d.$jscomp$loop$prop$i$22$24]={type:"scatter",data:{datasets:[{data:shipWidth,showLine:!0,borderDash:[5,5],label:"Ship Width (m)",
borderColor:"#505050",fill:!1,pointRadius:commonPointRadius,pointHitRadius:5}]},options:{title:{display:!0,text:"Internal Width Traveled before Detonation | "+targetedArmor+" | "+targetInclination+" | Horizontal Impact Angle: "+v_angles[d.$jscomp$loop$prop$i$22$24]+"\u00c2\u00b0"},scales:{xAxes:xAxesDistance,yAxes:[{scaleLabel:{display:!0,labelString:"Shell Detonation Distance (m)"}}]},animation:animationCommon}};addTooltipCallbackPostPen(c[d.$jscomp$loop$prop$i$22$24]);graphShip.map(function(d){return function(e,
f){if(e){var g=graphSettings.enableFills;c[d.$jscomp$loop$prop$i$22$24].data.datasets.push({data:d.$jscomp$loop$prop$results$25[2*f],showLine:!0,label:a+shipName[f],backgroundColor:Samples.utils.transparentize(colors[f][0]),borderColor:colors[f][0],fill:g,pointRadius:commonPointRadius,pointHitRadius:5},{data:d.$jscomp$loop$prop$results$25[2*f+1],showLine:!0,label:b+shipName[f],backgroundColor:Samples.utils.transparentize(colors[f][1]),borderColor:colors[f][1],fill:g,pointRadius:commonPointRadius,
pointHitRadius:5})}}}(d));createUpdateChart(postCharts,d.$jscomp$loop$prop$i$22$24,"postPen"+d.$jscomp$loop$prop$i$22$24,c[d.$jscomp$loop$prop$i$22$24]);d={$jscomp$loop$prop$i$22$24:d.$jscomp$loop$prop$i$22$24,$jscomp$loop$prop$results$25:d.$jscomp$loop$prop$results$25};d.$jscomp$loop$prop$i$22$24++;return g.jumpTo(2)})};
